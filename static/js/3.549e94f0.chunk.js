(this.webpackJsonp=this.webpackJsonp||[]).push([[3],{3262:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(264),n=r(3303);function o(e){return e&&"object"===typeof e&&"default"in e?e:{default:e}}var s=o(i),c=o(n);function a(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{a(i.next(e))}catch(t){o(t)}}function c(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}a((i=i.apply(e,t||[])).next())}))}var u,l={exports:{}},d="object"===typeof Reflect?Reflect:null,h=d&&"function"===typeof d.apply?d.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};u=d&&"function"===typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var v=Number.isNaN||function(e){return e!==e};function f(){f.init.call(this)}l.exports=f,l.exports.once=function(e,t){return new Promise((function(r,i){function n(r){e.removeListener(t,o),i(r)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}E(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&E(e,"error",t,r)}(e,n,{once:!0})}))},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var p=10;function y(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function m(e){return void 0===e._maxListeners?f.defaultMaxListeners:e._maxListeners}function _(e,t,r,i){var n,o,s;if(y(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"===typeof s?s=o[t]=i?[r,s]:[s,r]:i?s.unshift(r):s.push(r),(n=m(e))>0&&s.length>n&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,console&&console.warn}return e}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=D.bind(i);return n.listener=r,i.wrapFn=n,n}function g(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):S(n,n.length)}function w(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function S(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function E(e,t,r,i){if("function"===typeof e.on)i.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(o){i.once&&e.removeEventListener(t,n),r(o)}))}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(e){if("number"!==typeof e||e<0||v(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");p=e}}),f.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||v(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},f.prototype.getMaxListeners=function(){return m(this)},f.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,n=this._events;if(void 0!==n)i=i&&void 0===n.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=n[e];if(void 0===c)return!1;if("function"===typeof c)h(c,this,t);else{var a=c.length,u=S(c,a);for(r=0;r<a;++r)h(u[r],this,t)}return!0},f.prototype.addListener=function(e,t){return _(this,e,t,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(e,t){return _(this,e,t,!0)},f.prototype.once=function(e,t){return y(t),this.on(e,C(this,e,t)),this},f.prototype.prependOnceListener=function(e,t){return y(t),this.prependListener(e,C(this,e,t)),this},f.prototype.removeListener=function(e,t){var r,i,n,o,s;if(y(t),void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(n=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,n=o;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,o=Object.keys(r);for(i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},f.prototype.listeners=function(e){return g(this,e,!0)},f.prototype.rawListeners=function(e){return g(this,e,!1)},f.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):w.call(e,t)},f.prototype.listenerCount=w,f.prototype.eventNames=function(){return this._eventsCount>0?u(this._events):[]};const I=new l.exports,F=i.initLog("@onekey/hd-ble-sdk");let U,b=i.parseConnectSettings(),P=0;const k={};function R(e){const{event:t}=e;if(U)switch(F.debug("hd-ble-sdk handleMessage",e),t){case i.UI_EVENT:I.emit(e.event,e),I.emit(e.type,e.payload);break;default:F.log("No need to be captured message",e.event)}}function L(e,t=!0){return a(this,void 0,void 0,(function*(){if(!U)throw i.ERRORS.TypedError("Runtime","postMessage: _core not found");if(t){P++,k[P]=i.create();return yield U.handleMessage(Object.assign(Object.assign({},e),{id:""+P}))}U.handleMessage(e)}))}const O=s.default({eventEmitter:I,init:e=>a(void 0,void 0,void 0,(function*(){b=Object.assign(Object.assign(Object.assign({},b),e),{env:"react-native"}),i.enableLog(!!e.debug),F.debug("init");try{return U=yield i.initCore(b,c.default),null===U||void 0===U||U.on(i.CORE_EVENT,R),!0}catch(t){return F.error(i.createErrorMessage(t)),!1}})),call:e=>a(void 0,void 0,void 0,(function*(){var t,r;F.debug("call: ",e);try{const o=yield L({event:i.IFRAME.CALL,type:i.IFRAME.CALL,payload:e});return o?(F.debug("response: ",o),o.success||(("string"===typeof o.payload&&o.payload.includes(n.PERMISSION_ERROR)||(null===(t=o.payload.error)||void 0===t?void 0:t.includes(n.PERMISSION_ERROR)))&&L(i.createUiMessage(i.UI_REQUEST.BLUETOOTH_PERMISSION),!1),(null===(r=o.payload.error)||void 0===r?void 0:r.includes(n.LOCATION_ERROR))&&L(i.createUiMessage(i.UI_REQUEST.LOCATION_PERMISSION),!1)),o):i.createErrorMessage(i.ERRORS.TypedError("Call_NotResponse"))}catch(o){return F.error("__call error: ",o),i.createErrorMessage(o)}})),cancel:e=>{void 0!==U&&U.handleMessage({event:i.IFRAME.CANCEL,type:i.IFRAME.CANCEL,payload:{connectId:e}})},dispose:()=>{I.removeAllListeners(),b=i.parseConnectSettings()},uiResponse:e=>{if(!U)throw i.ERRORS.TypedError("Init_NotInitialized");const{type:t,payload:r}=e;U.handleMessage({event:i.UI_EVENT,type:t,payload:r})}});t.default=O,t.messagePromises=k},3303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(55),n=r(33),o=r(2059),s=r(3304),c=r(2060),a=r(1451);function u(e){return e&&"object"===typeof e&&"default"in e?e:{default:e}}var l=u(o),d=u(c),h=u(a);function v(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{a(i.next(e))}catch(t){o(t)}}function c(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}a((i=i.apply(e,t||[])).next())}))}const f="Bluetooth required to be turned on",p={classic:{"00000001-0000-1000-8000-00805f9b34fb":{serviceUuid:"00000001-0000-1000-8000-00805f9b34fb",writeUuid:"00000002-0000-1000-8000-00805f9b34fb",notifyUuid:"00000003-0000-1000-8000-00805f9b34fb"}}},y=[];for(const b of Object.keys(p)){const e=p[b];y.push(...Object.keys(e))}const m=()=>y,_=(e,t)=>{const r=p[t];if(!r)return null;const i=r[e];return i||null},D={timeout:(e,t)=>{const r=setTimeout(e,t);return()=>clearTimeout(r)}},C=(e,t=1e3)=>new Promise((r,i)=>{let n=!1;const o=e.onStateChange(e=>{if("PoweredOn"===e){if(n)return;s(),n=!0,o.remove(),r()}},!0),s=D.timeout(()=>{n||(o.remove(),i(new Error(f)))},t)});class g{constructor(e,t,r){this.mtuSize=20,this.id=e.id,this.device=e,this.writeCharacteristic=t,this.notifyCharacteristic=r}}const{check:w,buildBuffers:S,receiveOne:E,parseConfigure:I}=l.default,F={};let U={requestMTU:512,timeout:3e3};t.LOCATION_ERROR="Device is not authorized to use BluetoothLE",t.PERMISSION_ERROR=f,t.default=class{constructor(e){var t;this.configured=!1,this.stopped=!1,this.scanTimeout=3e3,this.runPromise=null,this.scanTimeout=null!==(t=e.scanTimeout)&&void 0!==t?t:3e3}init(){}configure(e){const t=I(e);this.configured=!0,this._messages=t}listen(){}getPlxManager(){return this.blePlxManager||(this.blePlxManager=new s.BleManager,h.default.start({showAlert:!1})),Promise.resolve(this.blePlxManager)}enumerate(){return v(this,void 0,void 0,(function*(){return new Promise((e,t)=>v(this,void 0,void 0,(function*(){const r=[],i=yield this.getPlxManager();try{yield C(i)}catch(c){return void t(c)}var n;i.startDeviceScan(null,{scanMode:s.ScanMode.LowLatency},(e,r)=>{var i;if(e)[s.BleErrorCode.BluetoothPoweredOff,s.BleErrorCode.BluetoothInUnknownState].includes(e.errorCode)?t(new Error(f)):t(e);else if(((e,t)=>{var r;if(null===(r=null===t||void 0===t?void 0:t.startsWith)||void 0===r?void 0:r.call(t,"MI"))return!0;return!(!e||!/(BixinKey\d{10})|(K\d{4})|(T\d{4})/i.exec(e))})(null!==(i=null===r||void 0===r?void 0:r.name)&&void 0!==i?i:null,null===r||void 0===r?void 0:r.id)){const{name:e,localName:t,id:i}=null!==r&&void 0!==r?r:{};o(r)}}),(n=m(),v(void 0,void 0,void 0,(function*(){return(yield h.default.getConnectedPeripherals(n)).map(e=>{const{id:t,name:r,advertising:i={}}=e;return Object.assign({id:t,name:r},i)})}))).then(e=>{for(const t of e)o(t)});const o=e=>{r.every(t=>t.id!==e.id)&&r.push(e)};D.timeout(()=>{i.stopDeviceScan(),e(r)},this.scanTimeout)})))}))}acquire(e){return v(this,void 0,void 0,(function*(){const{uuid:t}=e;if(!t)throw new Error("uuid is required");let r=null;F[t]&&(yield this.release(t));const n=yield this.getPlxManager();try{yield C(n)}catch(y){throw y}if(!r){const e=yield n.devices([t]);[r]=e}if(!r){const e=(yield n.connectedDevices(m())).filter(e=>e.id===t);[r]=e}if(!r)try{r=yield n.connectToDevice(t,U)}catch(D){if(D.errorCode!==s.BleErrorCode.DeviceMTUChangeFailed&&D.errorCode!==s.BleErrorCode.OperationCancelled)throw D;U={},r=yield n.connectToDevice(t)}if(!r)throw new Error("unable to connect to device");if(!(yield r.isConnected()))try{yield r.connect(U)}catch(D){if(D.errorCode!==s.BleErrorCode.DeviceMTUChangeFailed&&D.errorCode!==s.BleErrorCode.OperationCancelled)throw D;U={},yield r.connect()}if("android"===i.Platform.OS){if(!!!(yield v(void 0,void 0,void 0,(function*(){return(yield h.default.getBondedPeripherals()).map(e=>{const{id:t,name:r,advertising:i={}}=e;return Object.assign({id:t,name:r},i)})}))).find(e=>e.id===(null===r||void 0===r?void 0:r.id)))throw new Error("device is not bonded")}yield r.discoverAllServicesAndCharacteristics();let o,c=(e=>{if(!e||!e.serviceUUIDs)return null;const[t]=e.serviceUUIDs,r=_(t,"classic");return r||null})(r);if(!c)for(const e of m())try{o=yield r.characteristicsForService(e),c=_(e,"classic");break}catch(D){}if(!c)throw new Error("BLEServiceNotFound: service not found");const{serviceUuid:a,writeUuid:u,notifyUuid:l}=c;if(o||(o=yield r.characteristicsForService(a)),!o)throw new Error("BLEServiceNotFound: characteristics not found");let d,f;for(const e of o)e.uuid===u?d=e:e.uuid===l&&(f=e);if(!d)throw new Error("BLECharacteristicNotFound: write characteristic not found");if(!f)throw new Error("BLECharacteristicNotFound: notify characteristic not found");if(!d.isWritableWithResponse)throw new Error("BLECharacteristicNotWritable: write characteristic not writable");if(!f.isNotifiable)throw new Error("BLECharacteristicNotNotifiable: notify characteristic not notifiable");const p=new g(r,d,f);return p.nofitySubscription=this._monitorCharacteristic(p.notifyCharacteristic),F[t]=p,r.onDisconnected(()=>{this.release(t)}),{uuid:t}}))}_monitorCharacteristic(e){let t=0,r=[];const i=e.monitor((e,i)=>{var s,c;if(!e){if(!i)throw new Error("Monitor Error: characteristic not found");try{const e=n.Buffer.from(i.value,"base64");if((e=>{if(e.length<9)return!1;const[t,r,i]=e;return String.fromCharCode(t)===String.fromCharCode(o.MESSAGE_TOP_CHAR)&&String.fromCharCode(r)===String.fromCharCode(o.MESSAGE_HEADER_BYTE)&&String.fromCharCode(i)===String.fromCharCode(o.MESSAGE_HEADER_BYTE)})(e)?(t=e.readInt32BE(5),r=[...e.subarray(3)]):r=r.concat([...e]),r.length-o.COMMON_HEADER_SIZE>=t){const e=n.Buffer.from(r);t=0,r=[],null===(s=this.runPromise)||void 0===s||s.resolve(e.toString("hex"))}}catch(e){null===(c=this.runPromise)||void 0===c||c.reject(e)}}});return()=>{i.remove()}}release(e){var t,r;return v(this,void 0,void 0,(function*(){const n=F[e];return n&&(delete F[e],null===(t=n.nofitySubscription)||void 0===t||t.call(n),"android"===i.Platform.OS&&(yield null===(r=this.blePlxManager)||void 0===r?void 0:r.cancelDeviceConnection(e))),Promise.resolve(!0)}))}call(e,t,r){return v(this,void 0,void 0,(function*(){if(this.stopped)return Promise.reject("Transport stopped.");if(null==this._messages)throw new Error("Transport not configured.");if(this.runPromise)throw new Error("Transport_CallInProgress");const n=F[e];if(!n)throw new Error("Transport not found.");this.runPromise=function(e,t){let r,i=e=>{},n=e=>{};const o=new Promise((t,o)=>v(this,void 0,void 0,(function*(){if(i=t,n=o,"function"===typeof e)try{yield e()}catch(s){o(s)}"string"===typeof e&&(r=e)})));return{id:r,data:t,resolve:i,reject:n,promise:o}}();const o=this._messages,c=S(o,t,r);if("FirmwareUpload"===t){const e="ios"===i.Platform.OS?128:192;let t=0,r=d.default.allocate(e);for(;t<c.length;){const i=c[t].toBuffer();if(r.append(i),t+=1,r.offset===e||t>=c.length){r.reset();try{yield n.writeCharacteristic.writeWithoutResponse(r.toString("base64")),r=d.default.allocate(e)}catch(a){return void(this.runPromise=null)}}}}else for(const e of c){const t=e.toString("base64");try{yield n.writeCharacteristic.writeWithoutResponse(t)}catch(a){if(a.errorCode===s.BleErrorCode.DeviceDisconnected)throw new Error("device is not bonded");return void(this.runPromise=null)}}try{const e=yield this.runPromise.promise;if("string"!==typeof e)throw new Error("Returning data is not string.");const t=E(o,e);return w.call(t)}catch(a){return a}finally{this.runPromise=null}}))}stop(){this.stopped=!0}cancel(){this.runPromise,this.runPromise=null}}},3304:function(e,t,r){"use strict";r.r(t),r.d(t,"BleError",(function(){return m})),r.d(t,"BleErrorCode",(function(){return D})),r.d(t,"BleAndroidErrorCode",(function(){return S})),r.d(t,"BleIOSErrorCode",(function(){return w})),r.d(t,"BleATTErrorCode",(function(){return g})),r.d(t,"BleManager",(function(){return z})),r.d(t,"Device",(function(){return T})),r.d(t,"Service",(function(){return x})),r.d(t,"Characteristic",(function(){return B})),r.d(t,"Descriptor",(function(){return N})),r.d(t,"fullUUID",(function(){return p})),r.d(t,"State",(function(){return L})),r.d(t,"LogLevel",(function(){return O})),r.d(t,"ConnectionPriority",(function(){return M})),r.d(t,"ScanCallbackType",(function(){return R})),r.d(t,"ScanMode",(function(){return k}));var i,n=r(3),o=r.n(n),s=r(7),c=r.n(s),a=r(11),u=r.n(a),l=r(17),d=r.n(l),h=r(8),v=r.n(h),f=r(410);function p(e){return 4===e.length?"0000"+e.toLowerCase()+"-0000-1000-8000-00805f9b34fb":8===e.length?e.toLowerCase()+"-0000-1000-8000-00805f9b34fb":e.toLowerCase()}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=v()(e);if(t){var n=v()(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return d()(this,r)}}var m=function(e){u()(r,e);var t=y(r);function r(e,i){var n,o;if(c()(this,r),(n=t.call(this)).message=i[D.UnknownError],"string"===typeof e)n.errorCode=D.UnknownError,n.attErrorCode=null,n.iosErrorCode=null,n.androidErrorCode=null,n.reason=e;else{var s=i[e.errorCode];s&&(n.message=(o=e,s.replace(/\{([^}]+)\}/g,(function(e,t){return o[t]||"?"})))),n.errorCode=e.errorCode,n.attErrorCode=e.attErrorCode,n.iosErrorCode=e.iosErrorCode,n.androidErrorCode=e.androidErrorCode,n.reason=e.reason}return n.name="BleError",n}return r}(r.n(f)()(Error));function _(e,t){var r,i=t||C;try{var n=JSON.parse(e);r=new m(n,i)}catch(o){r=new m(e,i)}return r}var D={UnknownError:0,BluetoothManagerDestroyed:1,OperationCancelled:2,OperationTimedOut:3,OperationStartFailed:4,InvalidIdentifiers:5,BluetoothUnsupported:100,BluetoothUnauthorized:101,BluetoothPoweredOff:102,BluetoothInUnknownState:103,BluetoothResetting:104,BluetoothStateChangeFailed:105,DeviceConnectionFailed:200,DeviceDisconnected:201,DeviceRSSIReadFailed:202,DeviceAlreadyConnected:203,DeviceNotFound:204,DeviceNotConnected:205,DeviceMTUChangeFailed:206,ServicesDiscoveryFailed:300,IncludedServicesDiscoveryFailed:301,ServiceNotFound:302,ServicesNotDiscovered:303,CharacteristicsDiscoveryFailed:400,CharacteristicWriteFailed:401,CharacteristicReadFailed:402,CharacteristicNotifyChangeFailed:403,CharacteristicNotFound:404,CharacteristicsNotDiscovered:405,CharacteristicInvalidDataFormat:406,DescriptorsDiscoveryFailed:500,DescriptorWriteFailed:501,DescriptorReadFailed:502,DescriptorNotFound:503,DescriptorsNotDiscovered:504,DescriptorInvalidDataFormat:505,DescriptorWriteNotAllowed:506,ScanStartFailed:600,LocationServicesDisabled:601},C=(i={},o()(i,D.UnknownError,"Unknown error occurred. This is probably a bug! Check reason property."),o()(i,D.BluetoothManagerDestroyed,"BleManager was destroyed"),o()(i,D.OperationCancelled,"Operation was cancelled"),o()(i,D.OperationTimedOut,"Operation timed out"),o()(i,D.OperationStartFailed,"Operation was rejected"),o()(i,D.InvalidIdentifiers,"Invalid UUIDs or IDs were passed: {internalMessage}"),o()(i,D.BluetoothUnsupported,"BluetoothLE is unsupported on this device"),o()(i,D.BluetoothUnauthorized,"Device is not authorized to use BluetoothLE"),o()(i,D.BluetoothPoweredOff,"BluetoothLE is powered off"),o()(i,D.BluetoothInUnknownState,"BluetoothLE is in unknown state"),o()(i,D.BluetoothResetting,"BluetoothLE is resetting"),o()(i,D.BluetoothStateChangeFailed,"Bluetooth state change failed"),o()(i,D.DeviceConnectionFailed,"Device {deviceID} connection failed"),o()(i,D.DeviceDisconnected,"Device {deviceID} was disconnected"),o()(i,D.DeviceRSSIReadFailed,"RSSI read failed for device {deviceID}"),o()(i,D.DeviceAlreadyConnected,"Device {deviceID} is already connected"),o()(i,D.DeviceNotFound,"Device {deviceID} not found"),o()(i,D.DeviceNotConnected,"Device {deviceID} is not connected"),o()(i,D.DeviceMTUChangeFailed,"Device {deviceID} could not change MTU size"),o()(i,D.ServicesDiscoveryFailed,"Services discovery failed for device {deviceID}"),o()(i,D.IncludedServicesDiscoveryFailed,"Included services discovery failed for device {deviceID} and service: {serviceUUID}"),o()(i,D.ServiceNotFound,"Service {serviceUUID} for device {deviceID} not found"),o()(i,D.ServicesNotDiscovered,"Services not discovered for device {deviceID}"),o()(i,D.CharacteristicsDiscoveryFailed,"Characteristic discovery failed for device {deviceID} and service {serviceUUID}"),o()(i,D.CharacteristicWriteFailed,"Characteristic {characteristicUUID} write failed for device {deviceID} and service {serviceUUID}"),o()(i,D.CharacteristicReadFailed,"Characteristic {characteristicUUID} read failed for device {deviceID} and service {serviceUUID}"),o()(i,D.CharacteristicNotifyChangeFailed,"Characteristic {characteristicUUID} notify change failed for device {deviceID} and service {serviceUUID}"),o()(i,D.CharacteristicNotFound,"Characteristic {characteristicUUID} not found"),o()(i,D.CharacteristicsNotDiscovered,"Characteristics not discovered for device {deviceID} and service {serviceUUID}"),o()(i,D.CharacteristicInvalidDataFormat,"Cannot write to characteristic {characteristicUUID} with invalid data format: {internalMessage}"),o()(i,D.DescriptorsDiscoveryFailed,"Descriptor {descriptorUUID} discovery failed for device {deviceID}, service {serviceUUID} and characteristic {characteristicUUID}"),o()(i,D.DescriptorWriteFailed,"Descriptor {descriptorUUID} write failed for device {deviceID}, service {serviceUUID} and characteristic {characteristicUUID}"),o()(i,D.DescriptorReadFailed,"Descriptor {descriptorUUID} read failed for device {deviceID}, service {serviceUUID} and characteristic {characteristicUUID}"),o()(i,D.DescriptorNotFound,"Descriptor {descriptorUUID} not found"),o()(i,D.DescriptorsNotDiscovered,"Descriptors not discovered for device {deviceID}, service {serviceUUID} and characteristic {characteristicUUID}"),o()(i,D.DescriptorInvalidDataFormat,"Cannot write to descriptor {descriptorUUID} with invalid data format: {internalMessage}"),o()(i,D.DescriptorWriteNotAllowed,"Cannot write to descriptor {descriptorUUID}. It's not allowed by iOS and therefore forbidden on Android as well."),o()(i,D.ScanStartFailed,"Cannot start scanning operation"),o()(i,D.LocationServicesDisabled,"Location services are disabled"),i),g={Success:0,InvalidHandle:1,ReadNotPermitted:2,WriteNotPermitted:3,InvalidPdu:4,InsufficientAuthentication:5,RequestNotSupported:6,InvalidOffset:7,InsufficientAuthorization:8,PrepareQueueFull:9,AttributeNotFound:10,AttributeNotLong:11,InsufficientEncryptionKeySize:12,InvalidAttributeValueLength:13,UnlikelyError:14,InsufficientEncryption:15,UnsupportedGroupType:16,InsufficientResources:17},w={Unknown:0,InvalidParameters:1,InvalidHandle:2,NotConnected:3,OutOfSpace:4,OperationCancelled:5,ConnectionTimeout:6,PeripheralDisconnected:7,UuidNotAllowed:8,AlreadyAdvertising:9,ConnectionFailed:10,ConnectionLimitReached:11,UnknownDevice:12},S={NoResources:128,InternalError:129,WrongState:130,DbFull:131,Busy:132,Error:133,CmdStarted:134,IllegalParameter:135,Pending:136,AuthFail:137,More:138,InvalidCfg:139,ServiceStarted:140,EncrypedNoMitm:141,NotEncrypted:142,Congested:143},E=r(6),I=r.n(E),F=r(5),U=r.n(F),b=r(10),P=r.n(b),k={Opportunistic:-1,LowPower:0,Balanced:1,LowLatency:2},R={AllMatches:1,FirstMatch:2,MatchLost:4},L={Unknown:"Unknown",Resetting:"Resetting",Unsupported:"Unsupported",Unauthorized:"Unauthorized",PoweredOff:"PoweredOff",PoweredOn:"PoweredOn"},O={None:"None",Verbose:"Verbose",Debug:"Debug",Info:"Info",Warning:"Warning",Error:"Error"},M={Balanced:0,High:1,LowPower:2},T=function(){function e(t,r){c()(this,e),Object.assign(this,t,{_manager:r})}return P()(e,[{key:"requestConnectionPriority",value:function(e,t){return this._manager.requestConnectionPriorityForDevice(this.id,e,t)}},{key:"readRSSI",value:function(e){return this._manager.readRSSIForDevice(this.id,e)}},{key:"requestMTU",value:function(e,t){return this._manager.requestMTUForDevice(this.id,e,t)}},{key:"connect",value:function(e){return this._manager.connectToDevice(this.id,e)}},{key:"cancelConnection",value:function(){return this._manager.cancelDeviceConnection(this.id)}},{key:"isConnected",value:function(){return this._manager.isDeviceConnected(this.id)}},{key:"onDisconnected",value:function(e){return this._manager.onDeviceDisconnected(this.id,e)}},{key:"discoverAllServicesAndCharacteristics",value:function(e){return this._manager.discoverAllServicesAndCharacteristicsForDevice(this.id,e)}},{key:"services",value:function(){return this._manager.servicesForDevice(this.id)}},{key:"characteristicsForService",value:function(e){return this._manager.characteristicsForDevice(this.id,e)}},{key:"descriptorsForService",value:function(e,t){return this._manager.descriptorsForDevice(this.id,e,t)}},{key:"readCharacteristicForService",value:function(e,t,r){return this._manager.readCharacteristicForDevice(this.id,e,t,r)}},{key:"writeCharacteristicWithResponseForService",value:function(e,t,r,i){return this._manager.writeCharacteristicWithResponseForDevice(this.id,e,t,r,i)}},{key:"writeCharacteristicWithoutResponseForService",value:function(e,t,r,i){return this._manager.writeCharacteristicWithoutResponseForDevice(this.id,e,t,r,i)}},{key:"monitorCharacteristicForService",value:function(e,t,r,i){return this._manager.monitorCharacteristicForDevice(this.id,e,t,r,i)}},{key:"readDescriptorForService",value:function(){var e=U()((function*(e,t,r,i){return this._manager.readDescriptorForDevice(this.id,e,t,r,i)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"writeDescriptorForService",value:function(){var e=U()((function*(e,t,r,i,n){return this._manager.writeDescriptorForDevice(this.id,e,t,r,i,n)}));return function(t,r,i,n,o){return e.apply(this,arguments)}}()}]),e}(),x=function(){function e(t,r){c()(this,e),Object.assign(this,t,{_manager:r})}return P()(e,[{key:"characteristics",value:function(){return this._manager._characteristicsForService(this.id)}},{key:"descriptorsForCharacteristic",value:function(e){return this._manager._descriptorsForService(this.id,e)}},{key:"readCharacteristic",value:function(e,t){return this._manager._readCharacteristicForService(this.id,e,t)}},{key:"writeCharacteristicWithResponse",value:function(e,t,r){return this._manager._writeCharacteristicWithResponseForService(this.id,e,t,r)}},{key:"writeCharacteristicWithoutResponse",value:function(e,t,r){return this._manager._writeCharacteristicWithoutResponseForService(this.id,e,t,r)}},{key:"monitorCharacteristic",value:function(e,t,r){return this._manager._monitorCharacteristicForService(this.id,e,t,r)}},{key:"readDescriptorForCharacteristic",value:function(){var e=U()((function*(e,t,r){return this._manager._readDescriptorForService(this.id,e,t,r)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"writeDescriptorForCharacteristic",value:function(){var e=U()((function*(e,t,r,i){return this._manager._writeDescriptorForService(this.id,e,t,r,i)}));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),e}(),N=function(){function e(t,r){c()(this,e),Object.assign(this,t,{_manager:r})}return P()(e,[{key:"read",value:function(){var e=U()((function*(e){return this._manager._readDescriptor(this.id,e)}));return function(t){return e.apply(this,arguments)}}()},{key:"write",value:function(){var e=U()((function*(e,t){return this._manager._writeDescriptor(this.id,e,t)}));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),B=function(){function e(t,r){c()(this,e),Object.assign(this,t,{_manager:r})}return P()(e,[{key:"descriptors",value:function(){return this._manager._descriptorsForCharacteristic(this.id)}},{key:"read",value:function(e){return this._manager._readCharacteristic(this.id,e)}},{key:"writeWithResponse",value:function(e,t){return this._manager._writeCharacteristicWithResponse(this.id,e,t)}},{key:"writeWithoutResponse",value:function(e,t){return this._manager._writeCharacteristicWithoutResponse(this.id,e,t)}},{key:"monitor",value:function(e,t){return this._manager._monitorCharacteristic(this.id,e,t)}},{key:"readDescriptor",value:function(){var e=U()((function*(e,t){return this._manager._readDescriptorForCharacteristic(this.id,e,t)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"writeDescriptor",value:function(){var e=U()((function*(e,t,r){return this._manager._writeDescriptorForCharacteristic(this.id,e,t,r)}));return function(t,r,i){return e.apply(this,arguments)}}()}]),e}(),A=r(195),q=r(312),j=A.a.BleClientManager,W=q.a,z=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c()(this,e),this._eventEmitter=new W(j),this._uniqueId=0,this._activePromises={},this._activeSubscriptions={};var i=r.restoreStateFunction;null!=i&&null!=r.restoreStateIdentifier&&(this._activeSubscriptions[this._nextUniqueID()]=this._eventEmitter.addListener(j.RestoreStateEvent,(function(e){i(null!=e?{connectedPeripherals:e.connectedPeripherals.map((function(e){return new T(e,t)}))}:null)}))),this._errorCodesToMessagesMapping=r.errorCodesToMessagesMapping?r.errorCodesToMessagesMapping:C,j.createClient(r.restoreStateIdentifier||null)}return P()(e,[{key:"_destroyPromises",value:function(){var e=new m({errorCode:D.BluetoothManagerDestroyed,attErrorCode:null,iosErrorCode:null,androidErrorCode:null,reason:null},this._errorCodesToMessagesMapping);for(var t in this._activePromises)this._activePromises[t](e)}},{key:"_destroySubscriptions",value:function(){for(var e in this._activeSubscriptions)this._activeSubscriptions[e].remove()}},{key:"destroy",value:function(){j.destroyClient(),null!=this._scanEventSubscription&&(this._scanEventSubscription.remove(),this._scanEventSubscription=null),this._destroySubscriptions(),this._destroyPromises()}},{key:"_nextUniqueID",value:function(){return this._uniqueId+=1,this._uniqueId.toString()}},{key:"_callPromise",value:function(){var e=U()((function*(e){var t=this,r=this._nextUniqueID();try{var i=new Promise((function(e,i){t._activePromises[r]=i})),n=yield Promise.race([i,e]);return delete this._activePromises[r],n}catch(o){throw delete this._activePromises[r],_(o.message,this._errorCodesToMessagesMapping)}}));return function(t){return e.apply(this,arguments)}}()},{key:"setLogLevel",value:function(e){j.setLogLevel(e)}},{key:"logLevel",value:function(){return this._callPromise(j.logLevel())}},{key:"cancelTransaction",value:function(e){j.cancelTransaction(e)}},{key:"enable",value:function(){var e=U()((function*(e){return e||(e=this._nextUniqueID()),yield this._callPromise(j.enable(e)),this}));return function(t){return e.apply(this,arguments)}}()},{key:"disable",value:function(){var e=U()((function*(e){return e||(e=this._nextUniqueID()),yield this._callPromise(j.disable(e)),this}));return function(t){return e.apply(this,arguments)}}()},{key:"state",value:function(){return this._callPromise(j.state())}},{key:"onStateChange",value:function(e){var t,r=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._eventEmitter.addListener(j.StateChangeEvent,e),o=this._nextUniqueID();if(i){var s=!1;this._callPromise(this.state()).then((function(t){s||e(t)})),t={remove:function(){null!=r._activeSubscriptions[o]&&(s=!0,delete r._activeSubscriptions[o],n.remove())}}}else t={remove:function(){null!=r._activeSubscriptions[o]&&(delete r._activeSubscriptions[o],n.remove())}};return this._activeSubscriptions[o]=t,t}},{key:"startDeviceScan",value:function(e,t,r){var i=this;this.stopDeviceScan();this._scanEventSubscription=this._eventEmitter.addListener(j.ScanEvent,(function(e){var t=I()(e,2),n=t[0],o=t[1];r(n?_(n,i._errorCodesToMessagesMapping):null,o?new T(o,i):null)})),j.startDeviceScan(e,t)}},{key:"stopDeviceScan",value:function(){null!=this._scanEventSubscription&&(this._scanEventSubscription.remove(),this._scanEventSubscription=null),j.stopDeviceScan()}},{key:"requestConnectionPriorityForDevice",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.requestConnectionPriorityForDevice(e,t,r));return new T(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"readRSSIForDevice",value:function(){var e=U()((function*(e,t){t||(t=this._nextUniqueID());var r=yield this._callPromise(j.readRSSIForDevice(e,t));return new T(r,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"requestMTUForDevice",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.requestMTUForDevice(e,t,r));return new T(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"devices",value:function(){var e=U()((function*(e){var t=this;return(yield this._callPromise(j.devices(e))).map((function(e){return new T(e,t)}))}));return function(t){return e.apply(this,arguments)}}()},{key:"connectedDevices",value:function(){var e=U()((function*(e){var t=this;return(yield this._callPromise(j.connectedDevices(e))).map((function(e){return new T(e,t)}))}));return function(t){return e.apply(this,arguments)}}()},{key:"connectToDevice",value:function(){var e=U()((function*(e,t){var r=yield this._callPromise(j.connectToDevice(e,t));return new T(r,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"cancelDeviceConnection",value:function(){var e=U()((function*(e){var t=yield this._callPromise(j.cancelDeviceConnection(e));return new T(t,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onDeviceDisconnected",value:function(e,t){var r=this,i=this._eventEmitter.addListener(j.DisconnectionEvent,(function(i){var n=I()(i,2),o=n[0],s=n[1];e===s.id&&t(o?_(o,r._errorCodesToMessagesMapping):null,new T(s,r))})),n=this._nextUniqueID(),o={remove:function(){null!=r._activeSubscriptions[n]&&(delete r._activeSubscriptions[n],i.remove())}};return this._activeSubscriptions[n]=o,o}},{key:"isDeviceConnected",value:function(e){return this._callPromise(j.isDeviceConnected(e))}},{key:"discoverAllServicesAndCharacteristicsForDevice",value:function(){var e=U()((function*(e,t){t||(t=this._nextUniqueID());var r=yield this._callPromise(j.discoverAllServicesAndCharacteristicsForDevice(e,t));return new T(r,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"servicesForDevice",value:function(){var e=U()((function*(e){var t=this;return(yield this._callPromise(j.servicesForDevice(e))).map((function(e){return new x(e,t)}))}));return function(t){return e.apply(this,arguments)}}()},{key:"characteristicsForDevice",value:function(e,t){return this._handleCharacteristics(j.characteristicsForDevice(e,t))}},{key:"_characteristicsForService",value:function(e){return this._handleCharacteristics(j.characteristicsForService(e))}},{key:"_handleCharacteristics",value:function(){var e=U()((function*(e){var t=this;return(yield this._callPromise(e)).map((function(e){return new B(e,t)}))}));return function(t){return e.apply(this,arguments)}}()},{key:"descriptorsForDevice",value:function(e,t,r){return this._handleDescriptors(j.descriptorsForDevice(e,t,r))}},{key:"_descriptorsForService",value:function(e,t){return this._handleDescriptors(j.descriptorsForService(e,t))}},{key:"_descriptorsForCharacteristic",value:function(e){return this._handleDescriptors(j.descriptorsForCharacteristic(e))}},{key:"_handleDescriptors",value:function(){var e=U()((function*(e){var t=this;return(yield this._callPromise(e)).map((function(e){return new N(e,t)}))}));return function(t){return e.apply(this,arguments)}}()},{key:"readCharacteristicForDevice",value:function(){var e=U()((function*(e,t,r,i){i||(i=this._nextUniqueID());var n=yield this._callPromise(j.readCharacteristicForDevice(e,t,r,i));return new B(n,this)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"_readCharacteristicForService",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.readCharacteristicForService(e,t,r));return new B(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"_readCharacteristic",value:function(){var e=U()((function*(e,t){t||(t=this._nextUniqueID());var r=yield this._callPromise(j.readCharacteristic(e,t));return new B(r,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"writeCharacteristicWithResponseForDevice",value:function(){var e=U()((function*(e,t,r,i,n){n||(n=this._nextUniqueID());var o=yield this._callPromise(j.writeCharacteristicForDevice(e,t,r,i,!0,n));return new B(o,this)}));return function(t,r,i,n,o){return e.apply(this,arguments)}}()},{key:"_writeCharacteristicWithResponseForService",value:function(){var e=U()((function*(e,t,r,i){i||(i=this._nextUniqueID());var n=yield this._callPromise(j.writeCharacteristicForService(e,t,r,!0,i));return new B(n,this)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"_writeCharacteristicWithResponse",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.writeCharacteristic(e,t,!0,r));return new B(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"writeCharacteristicWithoutResponseForDevice",value:function(){var e=U()((function*(e,t,r,i,n){n||(n=this._nextUniqueID());var o=yield this._callPromise(j.writeCharacteristicForDevice(e,t,r,i,!1,n));return new B(o,this)}));return function(t,r,i,n,o){return e.apply(this,arguments)}}()},{key:"_writeCharacteristicWithoutResponseForService",value:function(){var e=U()((function*(e,t,r,i){i||(i=this._nextUniqueID());var n=yield this._callPromise(j.writeCharacteristicForService(e,t,r,!1,i));return new B(n,this)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"_writeCharacteristicWithoutResponse",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.writeCharacteristic(e,t,!1,r));return new B(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"monitorCharacteristicForDevice",value:function(e,t,r,i,n){var o=n||this._nextUniqueID();return this._handleMonitorCharacteristic(j.monitorCharacteristicForDevice(e,t,r,o),o,i)}},{key:"_monitorCharacteristicForService",value:function(e,t,r,i){var n=i||this._nextUniqueID();return this._handleMonitorCharacteristic(j.monitorCharacteristicForService(e,t,n),n,r)}},{key:"_monitorCharacteristic",value:function(e,t,r){var i=r||this._nextUniqueID();return this._handleMonitorCharacteristic(j.monitorCharacteristic(e,i),i,t)}},{key:"_handleMonitorCharacteristic",value:function(e,t,r){var i=this,n=this._eventEmitter.addListener(j.ReadEvent,(function(e){var n=I()(e,3),o=n[0],s=n[1],c=n[2];t===c&&(o?r(_(o,i._errorCodesToMessagesMapping),null):r(null,new B(s,i)))})),o=this._nextUniqueID(),s={remove:function(){null!=i._activeSubscriptions[o]&&(delete i._activeSubscriptions[o],n.remove())}};return this._activeSubscriptions[o]=s,this._callPromise(e).then((function(){s.remove()}),(function(e){r(e,null),s.remove()})),{remove:function(){j.cancelTransaction(t)}}}},{key:"readDescriptorForDevice",value:function(){var e=U()((function*(e,t,r,i,n){n||(n=this._nextUniqueID());var o=yield this._callPromise(j.readDescriptorForDevice(e,t,r,i,n));return new N(o,this)}));return function(t,r,i,n,o){return e.apply(this,arguments)}}()},{key:"_readDescriptorForService",value:function(){var e=U()((function*(e,t,r,i){i||(i=this._nextUniqueID());var n=yield this._callPromise(j.readDescriptorForService(e,t,r,i));return new N(n,this)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"_readDescriptorForCharacteristic",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.readDescriptorForCharacteristic(e,t,r));return new N(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"_readDescriptor",value:function(){var e=U()((function*(e,t){t||(t=this._nextUniqueID());var r=yield this._callPromise(j.readDescriptor(e,t));return new N(r,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"writeDescriptorForDevice",value:function(){var e=U()((function*(e,t,r,i,n,o){o||(o=this._nextUniqueID());var s=yield this._callPromise(j.writeDescriptorForDevice(e,t,r,i,n,o));return new N(s,this)}));return function(t,r,i,n,o,s){return e.apply(this,arguments)}}()},{key:"_writeDescriptorForService",value:function(){var e=U()((function*(e,t,r,i,n){n||(n=this._nextUniqueID());var o=yield this._callPromise(j.writeDescriptorForService(e,t,r,i,n));return new N(o,this)}));return function(t,r,i,n,o){return e.apply(this,arguments)}}()},{key:"_writeDescriptorForCharacteristic",value:function(){var e=U()((function*(e,t,r,i){i||(i=this._nextUniqueID());var n=yield this._callPromise(j.writeDescriptorForCharacteristic(e,t,r,i));return new N(n,this)}));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"_writeDescriptor",value:function(){var e=U()((function*(e,t,r){r||(r=this._nextUniqueID());var i=yield this._callPromise(j.writeDescriptor(e,t,r));return new N(i,this)}));return function(t,r,i){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=3.549e94f0.chunk.js.map